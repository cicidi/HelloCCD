package com.cicidi.ssh.model.jaxbInterprator;

import java.io.File;
import java.util.List;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Unmarshaller;
import javax.xml.transform.stream.StreamSource;

import com.cicidi.ssh.model.BookmarkRef;
import com.cicidi.ssh.model.Bookmarks;
import com.cicidi.ssh.model.Wrapper;

public class XmlReader<T> {

	@SuppressWarnings("unchecked")
	private static <T> List<T> unmarshal(Unmarshaller unmarshaller,
			Class<T> clazz, String xmlLocation) throws JAXBException {
		StreamSource xml = new StreamSource(xmlLocation);
		Wrapper<T> wrapper = (Wrapper<T>) unmarshaller.unmarshal(xml,
				Wrapper.class).getValue();
		return wrapper.getItems();
	}

	private static Object unmarshal(Unmarshaller unmarshaller,
			String xmlLocation) throws JAXBException {
		StreamSource xml = new StreamSource(xmlLocation);
		Object obj = unmarshaller.unmarshal(new File(xmlLocation));
		return obj;
	}

	public static void main(String[] args) {
		try {
			String fileName = "bookmark";
			String fileName_list = "bookmarks";
			String location = "src/main/resources/xml/" + fileName + ".xml";
			String location_list = "src/main/resources/xml/" + fileName_list
					+ ".xml";
			JAXBContext jaxbContext = null;
			jaxbContext = ModelJAXBContext.initContext();
			Unmarshaller jaxbUnmarshaller = jaxbContext.createUnmarshaller();
			List<Bookmarks> bookmarks = (List<Bookmarks>) unmarshal(
					jaxbUnmarshaller, Bookmarks.class, location_list);
			System.out.println(bookmarks);
			List<BookmarkRef> bookmark = (List<BookmarkRef>) unmarshal(
					jaxbUnmarshaller, BookmarkRef.class, location);
			System.out.println(bookmark);
			Bookmarks bookmarks_2 = (Bookmarks) unmarshal(jaxbUnmarshaller,
					location);
			System.out.println(bookmarks_2);

		} catch (JAXBException e) {
			e.printStackTrace();
		}

	}

}
